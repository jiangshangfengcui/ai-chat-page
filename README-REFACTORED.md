# AI Chat Page - 重构版本\n\n这是一个使用 React + TypeScript + GraphQL + Axios 重新构建的 AI 聊天应用。\n\n## 项目特性\n\n- 🚀 **现代化技术栈**: React 18 + TypeScript + Axios\n- 🎯 **清晰的架构**: 分离关注点，易于维护\n- 🎨 **美观的界面**: 保持原有的毛玻璃效果和渐变背景\n- 🔌 **GraphQL 集成**: 使用 Axios 实现 GraphQL 客户端\n- 📱 **响应式设计**: 适配移动端和桌面端\n- 🛠 **错误处理**: 完善的错误处理和回退机制\n- 🔄 **状态管理**: 使用 React Context 和 Hooks\n- ⚡ **优化性能**: 合理的组件拆分和状态管理\n\n## 项目结构\n\n```\nsrc/\n├── components/          # UI 组件\n│   ├── ChatWindow.tsx    # 聊天窗口组件\n│   ├── MessageBubble.tsx # 消息气泡组件\n│   ├── MessageInput.tsx  # 消息输入组件\n│   ├── ErrorBanner.tsx   # 错误提示组件\n│   └── LoadingSpinner.tsx # 加载动画组件\n├── contexts/            # React Context\n│   └── ChatContext.tsx   # 聊天状态管理\n├── hooks/              # 自定义 Hooks\n│   └── useChatOperations.ts # 聊天操作 Hook\n├── services/           # 业务逻辑层\n│   └── chatService.ts    # 聊天服务\n├── graphql/            # GraphQL 相关\n│   └── schema.ts         # GraphQL 类型定义和查询\n├── graphql-client/     # GraphQL 客户端\n│   └── client.ts         # Axios GraphQL 客户端\n├── App.tsx             # 主应用组件\n├── App.css             # 样式文件\n└── index.tsx           # 应用入口\n```\n\n## 主要改进\n\n### 1. 架构重构\n- **分离关注点**: 将 UI、状态管理、业务逻辑分离\n- **服务层**: 创建 `ChatService` 处理数据操作\n- **状态管理**: 使用 React Context 统一管理状态\n- **自定义 Hook**: 封装复杂逻辑，提高复用性\n\n### 2. 技术栈升级\n- **移除 Apollo Client**: 使用更轻量的 Axios\n- **类型安全**: 完善的 TypeScript 类型定义\n- **错误处理**: 统一的错误处理机制\n- **加载状态**: 更好的加载状态管理\n\n### 3. 用户体验优化\n- **连接状态显示**: 实时显示服务器连接状态\n- **错误提示**: 用户友好的错误提示横幅\n- **加载动画**: 优雅的加载状态显示\n- **键盘支持**: 支持 Enter 键发送消息\n\n## 安装和运行\n\n1. 安装依赖：\n```bash\nnpm install\n# 或\nyarn install\n```\n\n2. 启动开发服务器：\n```bash\nnpm start\n# 或\nyarn start\n```\n\n3. 构建生产版本：\n```bash\nnpm run build\n# 或\nyarn build\n```\n\n## 环境配置\n\n在 `.env` 文件中配置 GraphQL 端点：\n```\nREACT_APP_GRAPHQL_ENDPOINT=http://localhost:4000/graphql\n```\n\n## GraphQL API\n\n应用支持以下 GraphQL 操作：\n\n### 查询消息\n```graphql\nquery GetMessages {\n  messages {\n    id\n    content\n    sender\n    timestamp\n  }\n}\n```\n\n### 发送消息\n```graphql\nmutation SendMessage($content: String!, $sender: String!) {\n  sendMessage(content: $content, sender: $sender) {\n    id\n    content\n    sender\n    timestamp\n  }\n}\n```\n\n## 配合 Worker 使用\n\n此应用可以与之前创建的 Cloudflare Worker 配合使用：\n\n1. 部署 Worker 到 Cloudflare\n2. 将 `REACT_APP_GRAPHQL_ENDPOINT` 设置为 Worker 的 URL + `/graphql`\n3. Worker 会自动处理 GraphQL 请求并调用 DeepSeek API\n\n## 样式保持\n\n- 保持了原有的毛玻璃效果和渐变背景\n- 响应式设计适配不同屏幕尺寸\n- 添加了连接状态指示器和错误处理 UI\n- 改进了加载状态的视觉效果\n\n## 开发说明\n\n- 所有组件都有完整的 TypeScript 类型定义\n- 使用函数式组件和 Hooks\n- 遵循 React 最佳实践\n- 代码结构清晰，易于维护和扩展", "old_string": "# AI Chat Page - 重构版本\n\n这是一个使用 React + TypeScript + GraphQL + Axios 重新构建的 AI 聊天应用。\n\n## 项目特性\n\n- 🚀 **现代化技术栈**: React 18 + TypeScript + Axios\n- 🎯 **清晰的架构**: 分离关注点，易于维护\n- 🎨 **美观的界面**: 保持原有的毛玻璃效果和渐变背景\n- 🔌 **GraphQL 集成**: 使用 Axios 实现 GraphQL 客户端\n- 📱 **响应式设计**: 适配移动端和桌面端\n- 🛠 **错误处理**: 完善的错误处理和回退机制\n- 🔄 **状态管理**: 使用 React Context 和 Hooks\n- ⚡ **优化性能**: 合理的组件拆分和状态管理\n\n## 项目结构\n\n```\nsrc/\n├── components/          # UI 组件\n│   ├── ChatWindow.tsx    # 聊天窗口组件\n│   ├── MessageBubble.tsx # 消息气泡组件\n│   ├── MessageInput.tsx  # 消息输入组件\n│   ├── ErrorBanner.tsx   # 错误提示组件\n│   └── LoadingSpinner.tsx # 加载动画组件\n├── contexts/            # React Context\n│   └── ChatContext.tsx   # 聊天状态管理\n├── hooks/              # 自定义 Hooks\n│   └── useChatOperations.ts # 聊天操作 Hook\n├── services/           # 业务逻辑层\n│   └── chatService.ts    # 聊天服务\n├── graphql/            # GraphQL 相关\n│   └── schema.ts         # GraphQL 类型定义和查询\n├── graphql-client/     # GraphQL 客户端\n│   └── client.ts         # Axios GraphQL 客户端\n├── App.tsx             # 主应用组件\n├── App.css             # 样式文件\n└── index.tsx           # 应用入口\n```\n\n## 主要改进\n\n### 1. 架构重构\n- **分离关注点**: 将 UI、状态管理、业务逻辑分离\n- **服务层**: 创建 `ChatService` 处理数据操作\n- **状态管理**: 使用 React Context 统一管理状态\n- **自定义 Hook**: 封装复杂逻辑，提高复用性\n\n### 2. 技术栈升级\n- **移除 Apollo Client**: 使用更轻量的 Axios\n- **类型安全**: 完善的 TypeScript 类型定义\n- **错误处理**: 统一的错误处理机制\n- **加载状态**: 更好的加载状态管理\n\n### 3. 用户体验优化\n- **连接状态显示**: 实时显示服务器连接状态\n- **错误提示**: 用户友好的错误提示横幅\n- **加载动画**: 优雅的加载状态显示\n- **键盘支持**: 支持 Enter 键发送消息\n\n## 安装和运行\n\n1. 安装依赖：\n```bash\nnpm install\n# 或\nyarn install\n```\n\n2. 启动开发服务器：\n```bash\nnpm start\n# 或\nyarn start\n```\n\n3. 构建生产版本：\n```bash\nnpm run build\n# 或\nyarn build\n```\n\n## 环境配置\n\n在 `.env` 文件中配置 GraphQL 端点：\n```\nREACT_APP_GRAPHQL_ENDPOINT=http://localhost:4000/graphql\n```\n\n## GraphQL API\n\n应用支持以下 GraphQL 操作：\n\n### 查询消息\n```graphql\nquery GetMessages {\n  messages {\n    id\n    content\n    sender\n    timestamp\n  }\n}\n```\n\n### 发送消息\n```graphql\nmutation SendMessage($content: String!, $sender: String!) {\n  sendMessage(content: $content, sender: $sender) {\n    id\n    content\n    sender\n    timestamp\n  }\n}\n```\n\n## 配合 Worker 使用\n\n此应用可以与之前创建的 Cloudflare Worker 配合使用：\n\n1. 部署 Worker 到 Cloudflare\n2. 将 `REACT_APP_GRAPHQL_ENDPOINT` 设置为 Worker 的 URL + `/graphql`\n3. Worker 会自动处理 GraphQL 请求并调用 DeepSeek API\n\n## 样式保持\n\n- 保持了原有的毛玻璃效果和渐变背景\n- 响应式设计适配不同屏幕尺寸\n- 添加了连接状态指示器和错误处理 UI\n- 改进了加载状态的视觉效果\n\n## 开发说明\n\n- 所有组件都有完整的 TypeScript 类型定义\n- 使用函数式组件和 Hooks\n- 遵循 React 最佳实践\n- 代码结构清晰，易于维护和扩展"